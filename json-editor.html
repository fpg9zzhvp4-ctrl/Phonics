<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phonics JSON Editor</title>
<style>
    body {
        font-family: "Comic Sans MS", Arial, sans-serif;
        padding: 1rem;
        background: #f0f8ff;
        color: #333;
    }
    h1 { text-align: center; color: #ff1493; }
    select, input[type="text"], button {
        padding: 8px 12px;
        font-size: 1rem;
        margin: 4px 0;
    }
    label { margin-right: 6px; }
    .word-line {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 4px 0;
    }
    .word-line input[type="text"] {
        text-transform: lowercase;
        flex: 1;
    }
    #wordsContainer {
        margin-top: 12px;
        border: 1px solid #ccc;
        padding: 8px;
        border-radius: 8px;
        background: #fff7fb;
    }
    #jsonOutput {
        white-space: pre-wrap;
        background: #f8f8f8;
        padding: 8px;
        border: 1px dashed #ccc;
        margin-top: 16px;
        border-radius: 8px;
    }
    button {
        cursor: pointer;
        border-radius: 6px;
        border: none;
        background: #ff69b4;
        color: #fff;
    }
    button:hover { background: #ff1493; }
</style>
</head>
<body>

<h1>Phonics JSON Editor</h1>

<div>
    <label for="levelSelect">Level:</label>
    <select id="levelSelect"></select>

    <label for="weekSelect">Week:</label>
    <select id="weekSelect"></select>
</div>

<div id="wordsContainer"></div>

<div style="margin-top: 12px;">
    <button id="addWordBtn">Add Word</button>
    <button id="generateJsonBtn">Generate JSON</button>
</div>

<pre id="jsonOutput"></pre>

<script>
const levelSelect = document.getElementById("levelSelect");
const weekSelect = document.getElementById("weekSelect");
const wordsContainer = document.getElementById("wordsContainer");
const addWordBtn = document.getElementById("addWordBtn");
const generateJsonBtn = document.getElementById("generateJsonBtn");
const jsonOutput = document.getElementById("jsonOutput");

let wordsData = [];

let wordsData = []; // This will hold all the words from your JSON

// --- Load existing JSON ---
async function loadJSON() {
    try {
        const res = await fetch("words.json"); // make sure words.json is in the same folder
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        if (Array.isArray(data)) {
            wordsData = data;
            renderWords(); // populate editor with the data
        }
    } catch (e) {
        console.warn("Could not load words.json:", e);
    }
}

loadJSON();

// Populate level and week selects
for (let i = 1; i <= 10; i++) {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = i;
    levelSelect.appendChild(opt);
}

for (let i = 1; i <= 6; i++) {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = i;
    weekSelect.appendChild(opt);
}

// Render words for selected level/week
function renderWords() {
    wordsContainer.innerHTML = "";
    const level = Number(levelSelect.value);
    const week = Number(weekSelect.value);
    if (!level || !week) return;

    const filtered = wordsData.filter(w => w.level === level && w.week === week);
    filtered.forEach((w, idx) => {
        const div = createWordLine(w.word, w.type === "alien", idx);
        wordsContainer.appendChild(div);
    });
}

levelSelect.addEventListener("change", renderWords);
weekSelect.addEventListener("change", renderWords);

// Create a word input line
function createWordLine(word = "", isAlien = false, index = null) {
    const div = document.createElement("div");
    div.className = "word-line";

    const wordInput = document.createElement("input");
    wordInput.type = "text";
    wordInput.value = word;
    wordInput.placeholder = "word";
    wordInput.style.textTransform = "lowercase";

    const alienCheckbox = document.createElement("input");
    alienCheckbox.type = "checkbox";
    alienCheckbox.checked = isAlien;

    const alienLabel = document.createElement("label");
    alienLabel.textContent = "Alien";
    alienLabel.style.marginRight = "12px";

    const removeBtn = document.createElement("button");
    removeBtn.textContent = "Remove";
    removeBtn.style.background = "#c62828";
    removeBtn.onclick = () => {
        wordsContainer.removeChild(div);
    }

    div.appendChild(wordInput);
    div.appendChild(alienCheckbox);
    div.appendChild(alienLabel);
    div.appendChild(removeBtn);

    return div;
}

// Add new empty word
addWordBtn.addEventListener("click", () => {
    const div = createWordLine();
    wordsContainer.appendChild(div);
});

// Generate JSON
generateJsonBtn.addEventListener("click", () => {
    const level = Number(levelSelect.value);
    const week = Number(weekSelect.value);
    if (!level || !week) {
        alert("Please select level and week.");
        return;
    }

    const wordLines = Array.from(wordsContainer.children);
    const newWords = wordLines.map(div => {
        const word = div.querySelector("input[type='text']").value.trim().toLowerCase();
        const isAlien = div.querySelector("input[type='checkbox']").checked;
        return { word, type: isAlien ? "alien" : "normal", level, week };
    }).filter(w => w.word);

    // Replace old words for this level/week
    wordsData = wordsData.filter(w => w.level !== level || w.week !== week);
    wordsData.push(...newWords);

    jsonOutput.textContent = JSON.stringify(wordsData, null, 2);
});

// Re-render when level/week changes
levelSelect.addEventListener("change", renderWords);
weekSelect.addEventListener("change", renderWords);
</script>

</body>
</html>